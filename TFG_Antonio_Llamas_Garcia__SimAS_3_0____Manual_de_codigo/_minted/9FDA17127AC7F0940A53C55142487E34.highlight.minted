\begin{MintedVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{package}\PYG{+w}{ }\PYG{n+nn}{gramatica}\PYG{p}{;}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.*}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.BaseFont}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.PdfWriter}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.PdfPageEventHelper}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.ColumnText}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.PdfPTable}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.PdfPCell}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{com.itextpdf.text.pdf.draw.LineSeparator}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.beans.property.IntegerProperty}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.beans.property.SimpleIntegerProperty}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.beans.property.SimpleStringProperty}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.beans.property.StringProperty}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.collections.FXCollections}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.collections.ObservableList}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.stage.FileChooser}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javafx.stage.Window}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{org.w3c.dom.Element}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{org.w3c.dom.Node}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{org.w3c.dom.NodeList}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{org.xml.sax.SAXException}\PYG{p}{;}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javax.xml.parsers.DocumentBuilder}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javax.xml.parsers.DocumentBuilderFactory}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{javax.xml.parsers.ParserConfigurationException}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.io.*}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.List}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.*}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.logging.Level}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{simulador.SimulacionFinal.HistorialPaso}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.logging.Logger}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.stream.Collectors}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.Enumeration}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.Arrays}\PYG{p}{;}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{java.util.Collections}\PYG{p}{;}


\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kd}{class} \PYG{n+nc}{Gramatica}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{    }\PYG{c+c1}{// Propiedades para permitir el binding con la UI en JavaFX}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n}{nombre}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{SimpleStringProperty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{SimpleStringProperty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n}{simbInicial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{SimpleStringProperty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n}{archivoFuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{SimpleStringProperty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Nombre del archivo fuente (sin extensión)}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{IntegerProperty}\PYG{+w}{ }\PYG{n}{estado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{SimpleIntegerProperty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{    }\PYG{c+c1}{// Colecciones de objetos de la gramática (modelo)}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{terminales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{NoTerminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerminales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Produccion}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{    }\PYG{c+c1}{// Colecciones para representar los modelos de las listas en la UI (por ejemplo, nombres de símbolos)}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{producciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tpredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{c+c1}{//private NuevaDerivacionDescGenerada derivacionGeneradaDesc;}

\PYG{+w}{    }\PYG{c+c1}{// Clase interna para representar nodos del árbol sintáctico}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kd}{static}\PYG{+w}{ }\PYG{k+kd}{class} \PYG{n+nc}{NodoArbol}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{valor}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{NodoArbol}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hijos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{NodoArbol}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{valor}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{valor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{valor}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Constructor con parámetros}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n+nf}{Gramatica}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{nombre}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{descripcion}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{descripcion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{archivoFuente}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Valor por defecto para gramáticas creadas desde cero}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Constructor con parámetros}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n+nf}{Gramatica}\PYG{p}{(}\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{nombre}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{descripcion}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getDescripcion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{archivoFuente}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getArchivoFuente}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{estado}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getEstado}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{producciones}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{simbInicial}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getNoTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Constructor sin parámetros}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n+nf}{Gramatica}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// En la versión Swing se llamaba a initComponents() para inicializar la UI,}
\PYG{+w}{        }\PYG{c+c1}{// pero aquí la clase Gramatica es parte del modelo, por lo que no se requiere.}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{archivoFuente}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Valor por defecto para gramáticas creadas desde cero}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Genera el nombre del archivo PDF según el tipo de informe y el idioma actual}
\PYG{c+cm}{     * @param tipoInforme Tipo de informe: \PYGZdq{}editor\PYGZdq{}, \PYGZdq{}simulador\PYGZdq{}, \PYGZdq{}simulacion\PYGZdq{}}
\PYG{c+cm}{     * @param bundle ResourceBundle para internacionalización}
\PYG{c+cm}{     * @return Nombre del archivo PDF}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{generarNombreArchivoPDF}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{tipoInforme}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getArchivoFuente}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Si no hay bundle, usar valores por defecto en español}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{bundle}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{protected}\PYG{+w}{ }\PYG{n}{Object}\PYG{+w}{ }\PYG{n+nf}{handleGetObject}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{key}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{switch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{key}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulador}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{simulador}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{default}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{key}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Enumeration}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getKeys}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{Collections}\PYG{p}{.}\PYG{n+na}{enumeration}\PYG{p}{(}\PYG{n}{Arrays}\PYG{p}{.}\PYG{n+na}{asList}\PYG{p}{(}
\PYG{+w}{                        }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulador}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulacion}\PYG{l+s}{\PYGZdq{}}
\PYG{+w}{                    }\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Si el nombre base es \PYGZdq{}untitled\PYGZdq{}, traducirlo según el idioma}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{baseNombre}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.untitled}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{switch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{tipoInforme}\PYG{p}{.}\PYG{n+na}{toLowerCase}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{editor}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.pdf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{simulador}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZus{}}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulador}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.pdf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZus{}}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{archivo.nombre.simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.pdf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{default}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{baseNombre}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.pdf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{actualizarNoTerminalesDesdeModel}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Crear un mapa para mantener las referencias originales de los NoTerminales}
\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{NoTerminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{mapaNoTerminales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                }\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toMap}\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{p}{:}\PYG{p}{:}\PYG{n}{getNombre}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Limpiar la lista de objetos NoTerminal}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{clear}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Actualizar la lista de objetos NoTerminal a partir de la lista de nombres}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{mapaNoTerminales}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{NoTerminal}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Getters y setters usando las propiedades}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setNombre}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{nombre}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n+nf}{nombreProperty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getDescripcion}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setDescripcion}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{descripcion}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{descripcion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n+nf}{descripcionProperty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getArchivoFuente}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{archivoFuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setArchivoFuente}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{archivoFuente}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{archivoFuente}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{archivoFuente}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n+nf}{archivoFuenteProperty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{archivoFuente}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n+nf}{getEstado}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{estado}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setEstado}\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{estado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{estado}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{estado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{IntegerProperty}\PYG{+w}{ }\PYG{n+nf}{estadoProperty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{estado}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setVocabulario}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Limpiar las listas existentes tanto de los modelos UI como de los datos del modelo}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{clear}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{clear}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{clear}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{clear}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Actualizar la lista de NoTerminales a partir de la lista de cadenas \PYGZsq{}noTerm\PYGZsq{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{noTerm}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{noterminal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{NoTerminal}\PYG{p}{(}\PYG{n}{s}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{noterminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{c+c1}{// También se guarda la lista de strings para la UI (binding a ListView, por ejemplo)}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{noTerm}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Actualizar la lista de Terminales a partir de la lista de cadenas \PYGZsq{}term\PYGZsq{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{term}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{terminal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Terminal}\PYG{p}{(}\PYG{n}{s}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{c+c1}{// También se guarda la lista de strings para la UI}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{term}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{numerarProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{index}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{produccion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{produccion}\PYG{p}{.}\PYG{n+na}{setNumero}\PYG{p}{(}\PYG{n}{index}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n+nf}{getNumeroProduccion}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccion}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{produccion}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// 🔥 Comparar exacto, no `contains`}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getNumero}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// No encontrada}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Métodos para terminales}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{terminales}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setTerminales}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{terminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{terminales}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{terminales}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{terminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{n}{Terminal}\PYG{p}{:}\PYG{p}{:}\PYG{n}{getNombre}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setTerminalesModel}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{term}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{term}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{n}{s}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Terminal}\PYG{p}{(}\PYG{n}{s}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Métodos para no terminales}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{NoTerminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getNoTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{noTerminales}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setNoTerminales}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{NoTerminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{noTerminales}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{noTerminales}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{noTerminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{p}{:}\PYG{p}{:}\PYG{n}{getNombre}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setNoTerminalesModel}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerminal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{noTerminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{noTerminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{actualizarNoTerminalesDesdeModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Métodos para producciones}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Produccion}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setProducciones}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Produccion}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{numerarProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{producciones}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{n}{Produccion}\PYG{p}{:}\PYG{p}{:}\PYG{n}{toString}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{producciones}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setProduccionesModel}\PYG{p}{(}\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{producciones}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{producciones}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{producciones}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{producciones}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{k}{this}\PYG{p}{:}\PYG{p}{:}\PYG{n}{crearProduccionDesdeString}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{numerarProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n+nf}{crearProduccionDesdeString}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partes}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Antecedente}\PYG{+w}{ }\PYG{n}{antec}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Antecedente}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{NoTerminal}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{antec}\PYG{p}{.}\PYG{n+na}{setSimboloNT}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Simbolo}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{consec}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{consec}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Simbolo}\PYG{p}{(}\PYG{n}{s}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{produccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Produccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{produccion}\PYG{p}{.}\PYG{n+na}{setAntec}\PYG{p}{(}\PYG{n}{antec}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{produccion}\PYG{p}{.}\PYG{n+na}{setConsec}\PYG{p}{(}\PYG{n}{consec}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{produccion}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Setter usando la propiedad de JavaFX}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setSimbInicial}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simInicial}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{simbInicial}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{simInicial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Getter usando la propiedad de JavaFX}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{simbInicial}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Método adicional para exponer la propiedad, útil para binding}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{StringProperty}\PYG{+w}{ }\PYG{n+nf}{simbInicialProperty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{simbInicial}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/*public NuevaDerivacionDescGenerada getDerivacionGeneradaDesc() \PYGZob{}}
\PYG{c+cm}{        return derivacionGeneradaDesc;}
\PYG{c+cm}{    \PYGZcb{}*/}

\PYG{+w}{    }\PYG{c+cm}{/*public void setDerivacionGeneradaDesc(NuevaDerivacionDescGenerada derivacionGeneradaDesc) \PYGZob{}}
\PYG{c+cm}{        this.derivacionGeneradaDesc = derivacionGeneradaDesc;}
\PYG{c+cm}{    \PYGZcb{}*/}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{selecSimboloInicial}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simInicial}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{simInicial}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{setSimboloInicial}\PYG{p}{(}\PYG{k+kc}{true}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n+nf}{guardarGramatica}\PYG{p}{(}\PYG{n}{Window}\PYG{+w}{ }\PYG{n}{ownerWindow}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Crear y configurar el FileChooser de JavaFX}
\PYG{+w}{        }\PYG{n}{FileChooser}\PYG{+w}{ }\PYG{n}{fileChooser}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileChooser}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fileChooser}\PYG{p}{.}\PYG{n+na}{getExtensionFilters}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileChooser}\PYG{p}{.}\PYG{n+na}{ExtensionFilter}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Archivos de XML}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{*.xml}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fileChooser}\PYG{p}{.}\PYG{n+na}{setTitle}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Guardar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Mostrar el diálogo de guardado (se le pasa el owner window, puede ser null si no se dispone)}
\PYG{+w}{        }\PYG{n}{File}\PYG{+w}{ }\PYG{n}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fileChooser}\PYG{p}{.}\PYG{n+na}{showSaveDialog}\PYG{p}{(}\PYG{n}{ownerWindow}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// El usuario canceló la operación}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Construir el documento XML}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{documentoXml}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Cabecera XML}
\PYG{+w}{        }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{sb}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}?xml version=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{1.0}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{ encoding=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{UTF\PYGZhy{}8}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{?\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}?xml\PYGZhy{}stylesheet type=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{text/xsl}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{ href=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{gramatica.xsl}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{?\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}grammar version=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{2.0}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{c+c1}{// Nombre y descripción}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}name\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/name\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}description\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getDescripcion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/description\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección de símbolos no terminales}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}non\PYGZhy{}terminal\PYGZhy{}symbols\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTermModel}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Asumimos que este método devuelve ObservableList\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{noTermModel}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}non\PYGZhy{}terminal\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}value\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/value\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/non\PYGZhy{}terminal\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/non\PYGZhy{}terminal\PYGZhy{}symbols\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección de símbolos terminales}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}terminal\PYGZhy{}symbols\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{termModel}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Asumimos que este método devuelve ObservableList\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{termModel}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}terminal\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}value\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/value\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/terminal\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/terminal\PYGZhy{}symbols\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Símbolo inicial}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}init\PYGZhy{}symbol\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/init\PYGZhy{}symbol\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección de reglas (producciones)}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}rule\PYGZhy{}set\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesModel}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Asumimos que este método devuelve ObservableList\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prodStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{produccionesModel}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Suponemos que cada producción está en el formato \PYGZdq{}Antecedente → simbolo1 simbolo2 ...\PYGZdq{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{prodStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partes}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{continue}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Formato incorrecto; saltamos esta producción.}

\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{leftPart}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{rightTokens}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{rightPartBuilder}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{rightToken}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{rightTokens}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{rightPartBuilder}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}symbol\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{rightPartBuilder}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}value\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{rightToken}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/value\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{rightPartBuilder}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/symbol\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}rule\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}leftPart\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}value\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{leftPart}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/value\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/leftPart\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}rightPart\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{rightPartBuilder}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/rightPart\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/rule\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{t\PYGZlt{}/rule\PYGZhy{}set\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZlt{}/grammar\PYGZgt{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{documentoXml}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Escribir el XML en el archivo usando try\PYGZhy{}with\PYGZhy{}resources para cerrar automáticamente}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{BufferedWriter}\PYG{+w}{ }\PYG{n}{out}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BufferedWriter}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileWriter}\PYG{p}{(}\PYG{n}{file}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{out}\PYG{p}{.}\PYG{n+na}{write}\PYG{p}{(}\PYG{n}{documentoXml}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{IOException}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Aquí podrías registrar el error o construir un mensaje de error detallado}
\PYG{+w}{            }\PYG{c+c1}{// Por ejemplo:}
\PYG{+w}{            }\PYG{c+c1}{// String codigoError = \PYGZdq{}E\PYGZhy{}8\PYGZdq{};}
\PYG{+w}{            }\PYG{c+c1}{// String mensajeError = \PYGZdq{}Error de entrada\PYGZhy{}salida al guardar el fichero de gramática.\PYGZdq{};}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n+nf}{cargarGramatica}\PYG{p}{(}\PYG{n}{Window}\PYG{+w}{ }\PYG{n}{ownerWindow}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Crear y configurar el FileChooser}
\PYG{+w}{        }\PYG{n}{FileChooser}\PYG{+w}{ }\PYG{n}{fileChooser}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileChooser}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fileChooser}\PYG{p}{.}\PYG{n+na}{getExtensionFilters}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileChooser}\PYG{p}{.}\PYG{n+na}{ExtensionFilter}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Gramaticas de SimAS (.xml)}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{*.xml}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Mostrar el diálogo y obtener el archivo seleccionado}
\PYG{+w}{        }\PYG{n}{File}\PYG{+w}{ }\PYG{n}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fileChooser}\PYG{p}{.}\PYG{n+na}{showOpenDialog}\PYG{p}{(}\PYG{n}{ownerWindow}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// El usuario canceló la operación}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Extraer el nombre del archivo sin extensión}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombreArchivo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{file}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nombreArchivo}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{nombreArchivo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nombreArchivo}\PYG{p}{.}\PYG{n+na}{substring}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nombreArchivo}\PYG{p}{.}\PYG{n+na}{lastIndexOf}\PYG{p}{(}\PYG{l+s+sc}{\PYGZsq{}.\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Variables para almacenar información del XML}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simboloInicial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{NT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{termModel}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{prodModel}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Preparar el analizador XML}
\PYG{+w}{            }\PYG{n}{DocumentBuilderFactory}\PYG{+w}{ }\PYG{n}{dbf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{DocumentBuilderFactory}\PYG{p}{.}\PYG{n+na}{newInstance}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{DocumentBuilder}\PYG{+w}{ }\PYG{n}{db}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{dbf}\PYG{p}{.}\PYG{n+na}{newDocumentBuilder}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{org}\PYG{p}{.}\PYG{n+na}{w3c}\PYG{p}{.}\PYG{n+na}{dom}\PYG{p}{.}\PYG{n+na}{Document}\PYG{+w}{ }\PYG{n}{doc}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{db}\PYG{p}{.}\PYG{n+na}{parse}\PYG{p}{(}\PYG{n}{file}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getDocumentElement}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{normalize}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Obtener la versión del documento}
\PYG{+w}{            }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{root}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getDocumentElement}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{version}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{root}\PYG{p}{.}\PYG{n+na}{getAttribute}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{version}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Extraer nombre y descripción}
\PYG{+w}{            }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nameList}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{root}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{name}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nameList}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{nombre}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nameList}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{descList}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{root}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{description}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{descList}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{descripcion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{descList}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{c+c1}{// Crear la gramática}
\PYG{+w}{            }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Extraer símbolos no terminales}
\PYG{+w}{            }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nodeNonTerminalSymbols}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{non\PYGZhy{}terminal}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodeNonTerminalSymbols}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodeNonTerminalSymbols}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elemento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{ntValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{NT}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{ntValue}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setNoTerminalesModel}\PYG{p}{(}\PYG{n}{NT}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Extraer símbolos terminales}
\PYG{+w}{            }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nodeTerminalSymbols}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{terminal}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodeTerminalSymbols}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodeTerminalSymbols}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elemento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{tValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{termModel}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tValue}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{c+c1}{// Asumimos que gramatica tiene un método setTerminales que acepta ObservableList\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{            }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setTerminalesModel}\PYG{p}{(}\PYG{n}{termModel}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Actualizar el vocabulario (se puede llamar a setVocabulario si ya lo encapsula)}
\PYG{+w}{            }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setVocabulario}\PYG{p}{(}\PYG{n}{NT}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{termModel}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Extraer símbolo inicial}
\PYG{+w}{            }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{initSymbolList}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{root}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{init\PYGZhy{}symbol}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{initSymbolList}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{simboloInicial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{initSymbolList}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setSimbInicial}\PYG{p}{(}\PYG{n}{simboloInicial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{c+c1}{// Extraer reglas (producciones)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{version}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{1.0}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rule}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elemento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{ruleValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{n}{prodModel}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{ruleValue}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{version}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{2.0}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rule}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elemento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{;}
\PYG{+w}{                        }\PYG{c+c1}{// Procesar lado izquierdo}
\PYG{+w}{                        }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{leftPart}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{leftPart}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{leftElement}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{leftPart}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{leftValueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{leftElement}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{leftValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{leftValueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{leftValueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}

\PYG{+w}{                        }\PYG{c+c1}{// Procesar lado derecho}
\PYG{+w}{                        }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{rightPart}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rightPart}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{rightElement}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{rightPart}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{rightSymbols}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{rightElement}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{symbol}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{rightValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{k}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{k}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{rightSymbols}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{k}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodoSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{rightSymbols}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{k}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodoSimbolo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                                }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elementoSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodoSimbolo}\PYG{p}{;}
\PYG{+w}{                                }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{rightValueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elementoSimbolo}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{rightValueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                                    }\PYG{n}{rightValue}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{rightValueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{k}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{rightSymbols}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                                        }\PYG{n}{rightValue}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                        }\PYG{c+c1}{// Formatear la producción con un separador \PYGZdq{}→\PYGZdq{}}
\PYG{+w}{                        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prodStr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{leftValue}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{rightValue}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{prodModel}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{prodStr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Versión por defecto similar a \PYGZdq{}1.0\PYGZdq{}}
\PYG{+w}{                }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{doc}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rule}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{Node}\PYG{+w}{ }\PYG{n}{nodo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodeRules}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{getNodeType}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Node}\PYG{p}{.}\PYG{n+na}{ELEMENT\PYGZus{}NODE}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{Element}\PYG{+w}{ }\PYG{n}{elemento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Element}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{NodeList}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{elemento}\PYG{p}{.}\PYG{n+na}{getElementsByTagName}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{value}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{getLength}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{ruleValue}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{valueNode}\PYG{p}{.}\PYG{n+na}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getTextContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{n}{prodModel}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{ruleValue}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{c+c1}{// Asumimos que gramatica tiene un método setProducciones que acepta ObservableList\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{            }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setProduccionesModel}\PYG{p}{(}\PYG{n}{prodModel}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{c+c1}{// Guardar el nombre del archivo fuente}
\PYG{+w}{            }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{setArchivoFuente}\PYG{p}{(}\PYG{n}{nombreArchivo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{c+c1}{//gramatica.numerarProducciones();}

\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{IOException}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{Gramatica}\PYG{p}{.}\PYG{n+na}{class}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ParserConfigurationException}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{Gramatica}\PYG{p}{.}\PYG{n+na}{class}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{SAXException}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{Gramatica}\PYG{p}{.}\PYG{n+na}{class}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{validarGramatica}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Usamos ObservableList para que, si se requiere, se pueda enlazar con la UI}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{mensajesError}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{c+c1}{// Variables locales para la validación}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Simbolo}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{conjSimbolos}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Validar existencia de producciones}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{producciones}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{No existen producciones.}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nLa gramática no contiene ninguna producción. Debería contener al menos una para poder ser válida.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar existencia de símbolos terminales}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{No existen símbolos terminales.}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nLa gramática no contiene ningún símbolo terminal. Debería contener al menos uno para poder ser válida.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar existencia de símbolos no terminales}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{No existen símbolos no terminales.}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nLa gramática no contiene ningún símbolo no terminal. Debería contener al menos uno para poder ser válida.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar asignación del símbolo inicial}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolo inicial no asignado.}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nLa gramática no tiene asignado el símbolo inicial.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar que cada símbolo terminal aparezca en el consecuente de alguna producción}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{p}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{conjSimbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{conjSimbolos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolo terminal no usado.}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                        }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{El símbolo terminal \PYGZsq{}}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZsq{} no aparece en ningún consecuente de ninguna producción.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar que cada símbolo no terminal aparezca en el consecuente de alguna producción}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{p}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{conjSimbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{conjSimbolos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Si el símbolo no terminal es el símbolo inicial, se considera encontrado}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Simbolo no terminal no usado. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                        }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{El símbolo no terminal }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ no aparece en ningún consecuente de ninguna producción.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar que el antecedente de cada producción exista entre los símbolos no terminales}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{p}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Antecedente}\PYG{+w}{ }\PYG{n}{antecProd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{antecProd}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Simbolo no terminal no usado. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                        }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{El símbolo no terminal }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{antecProd}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                        }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ no aparece en el antecedente de ninguna producción.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Validar que cada símbolo del consecuente pertenezca al conjunto de símbolos declarado}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{p}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Simbolo}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{consec}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{s}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{consec}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{                }\PYG{c+c1}{// Si el símbolo es épsilon (representado por ε) se considera válido}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Se busca en la lista de no terminales}
\PYG{+w}{                    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{c+c1}{// Si aún no se encontró, se busca en la lista de terminales}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                                }\PYG{n}{encontrado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                                }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{                            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{encontrado}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setEstado}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{mensajesError}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Consecuente erróneo. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{El símbolo }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ del consecuente de la producción no pertenece al conjunto de símbolos declarado.}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{mensajesError}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Boolean}\PYG{+w}{ }\PYG{n+nf}{generarInforme}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fichero}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Método original para compatibilidad \PYGZhy{} usa español por defecto}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{p}{.}\PYG{n+na}{getBundle}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{utils.messages}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{util}\PYG{p}{.}\PYG{n+na}{Locale}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{es}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{generarInforme}\PYG{p}{(}\PYG{n}{fichero}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Si no se puede cargar el bundle, usar valores por defecto}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{generarInforme}\PYG{p}{(}\PYG{n}{fichero}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Boolean}\PYG{+w}{ }\PYG{n+nf}{generarInforme}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fichero}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Solo genera el informe si la gramática está validada (estado==1)}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getEstado}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Si no hay bundle, usar valores por defecto en español}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{bundle}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{bundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n+nd}{@Override}
\PYG{+w}{                    }\PYG{k+kd}{protected}\PYG{+w}{ }\PYG{n}{Object}\PYG{+w}{ }\PYG{n+nf}{handleGetObject}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{key}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{switch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{key}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{INFORME DE GRAMÁTICA}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.detalles}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{DETALLES DE LA GRAMÁTICA}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.descripcion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Descripción}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolo.inicial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolo Inicial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolos.no.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolos No Terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolos.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolos Terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.informacion.adicional}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Información Adicional}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.estado.validacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Estado de validación}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Número total de producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.no.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Número de símbolos no terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Número de símbolos terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.fecha.generacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Fecha de generación}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.documento.generado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Documento generado por SimAS v3.0 \PYGZhy{} Simulador de Análisis Sintáctico}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.pagina}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Página}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.generado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Documento generado el}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                            }\PYG{k}{default}\PYG{p}{:}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{key}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                    }\PYG{n+nd}{@Override}
\PYG{+w}{                    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Enumeration}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getKeys}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{Collections}\PYG{p}{.}\PYG{n+na}{enumeration}\PYG{p}{(}\PYG{n}{Arrays}\PYG{p}{.}\PYG{n+na}{asList}\PYG{p}{(}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.detalles}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.descripcion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolo.inicial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolos.no.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simbolos.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.informacion.adicional}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.estado.validacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.no.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.numero.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.fecha.generacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.documento.generado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.pagina}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
\PYG{+w}{                            }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.generado}\PYG{l+s}{\PYGZdq{}}
\PYG{+w}{                        }\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Configuración inicial del documento \PYGZhy{} ESTILOS PROFESIONALES IDÉNTICOS}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fontPath}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{fonts/arial.ttf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Document}\PYG{p}{(}\PYG{n}{PageSize}\PYG{p}{.}\PYG{n+na}{A4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Crear el PdfWriter con gestión avanzada de páginas}
\PYG{+w}{                }\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{PdfWriter}\PYG{p}{.}\PYG{n+na}{getInstance}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileOutputStream}\PYG{p}{(}\PYG{n}{fichero}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Configurar esquema de colores profesional \PYGZhy{} IDÉNTICOS a los métodos profesionales}
\PYG{+w}{                }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{41}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{128}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{185}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{     }\PYG{c+c1}{// Azul profesional}
\PYG{+w}{                }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{52}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{152}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{219}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{   }\PYG{c+c1}{// Azul claro}
\PYG{+w}{                }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{230}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{126}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{34}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c+c1}{// Naranja}
\PYG{+w}{                }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{149}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{165}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{166}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{      }\PYG{c+c1}{// Gris neutro}

\PYG{+w}{                }\PYG{c+c1}{// Fuentes tipográficas profesionales \PYGZhy{} IDÉNTICAS}
\PYG{+w}{                }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{fontPath}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{IDENTITY\PYGZus{}H}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{COURIER}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{CP1252}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{32}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{piePagina}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{tituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{subtituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{tituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{subtituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{contenidoNormal}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{piePagina}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Configurar separadores visuales \PYGZhy{} IDÉNTICOS}
\PYG{+w}{                }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Event handler para encabezados y pies de página \PYGZhy{} IDÉNTICO}
\PYG{+w}{                }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{;}
\PYG{+w}{                }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{finalBf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{;}
\PYG{+w}{                }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{finalColorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{setPageEvent}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPageEventHelper}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n+nd}{@Override}
\PYG{+w}{                    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onEndPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{c+c1}{// Pie de página con numeración}
\PYG{+w}{                            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{finalBf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{n}{fontPie}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{finalColorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                            }\PYG{n}{ColumnText}\PYG{p}{.}\PYG{n+na}{showTextAligned}\PYG{p}{(}\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getDirectContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                                }\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{,}
\PYG{+w}{                                }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s \PYGZpc{}d}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.pagina}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getPageNumber}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                                }\PYG{p}{(}\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{right}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{left}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{leftMargin}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{bottom}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{e}\PYG{p}{.}\PYG{n+na}{printStackTrace}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                    }\PYG{n+nd}{@Override}
\PYG{+w}{                    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onStartPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{c+c1}{// Encabezado eliminado \PYGZhy{} no mostrar título en cada página}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{open}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{c+c1}{// PÁGINA 1: PORTADA PROFESIONAL \PYGZhy{} IDÉNTICA}
\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{n}{crearPortadaProfesional}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{c+c1}{// PÁGINA 2: CONTENIDO \PYGZhy{} SOLO GRAMÁTICA ORIGINAL}
\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{c+c1}{// SECCIÓN ÚNICA: GRAMÁTICA ORIGINAL}
\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloGramaticaOriginal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.editor.gramatica.original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloGramaticaOriginal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separadorSecundario}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Información básica de la gramática usando el método profesional}
\PYG{+w}{                }\PYG{n}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                          }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{c+c1}{// INFORMACIÓN FINAL \PYGZhy{} IDÉNTICA AL INFORME DE SIMULACIÓN}
\PYG{+w}{                }\PYG{c+c1}{// ========================================}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Información adicional}
\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{infoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{infoAdicional}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.creditos}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{infoAdicional}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{infoAdicional}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{fechaConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.fecha}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                    }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{LocalDate}\PYG{p}{.}\PYG{n+na}{now}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{.}\PYG{n+na}{DateTimeFormatter}\PYG{p}{.}\PYG{n+na}{ofPattern}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{dd/MM/yyyy}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{fechaConclusion}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{fechaConclusion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{close}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{BadElementException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de elemento en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{IOException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de E/S en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// Para capturar cualquier otra excepción}
\PYG{+w}{                }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error general en generación de PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Genera un informe PDF completo del simulador siguiendo el mismo formato profesional}
\PYG{c+cm}{     * pero sin las secciones: resumen ejecutivo, información de simulación, historial de pasos,}
\PYG{c+cm}{     * derivación, árbol sintáctico y conclusión.}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Boolean}\PYG{+w}{ }\PYG{n+nf}{generarInformeSimulador}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fichero}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}\PYG{+w}{ }
\PYG{+w}{                                         }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{FuncionError}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Configuración inicial del documento}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fontPath}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{fonts/arial.ttf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Document}\PYG{p}{(}\PYG{n}{PageSize}\PYG{p}{.}\PYG{n+na}{A4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }
\PYG{+w}{            }\PYG{c+c1}{// Crear el PdfWriter con gestión avanzada de páginas}
\PYG{+w}{            }\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{PdfWriter}\PYG{p}{.}\PYG{n+na}{getInstance}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileOutputStream}\PYG{p}{(}\PYG{n}{fichero}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }
\PYG{+w}{            }\PYG{c+c1}{// Configurar esquema de colores profesional}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{41}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{128}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{185}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{     }\PYG{c+c1}{// Azul profesional}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{52}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{152}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{219}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{   }\PYG{c+c1}{// Azul claro}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{230}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{126}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{34}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c+c1}{// Naranja}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{149}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{165}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{166}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{      }\PYG{c+c1}{// Gris neutro}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{236}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{241}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Gris muy claro}

\PYG{+w}{            }\PYG{c+c1}{// Fuentes tipográficas profesionales}
\PYG{+w}{            }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{fontPath}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{IDENTITY\PYGZus{}H}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{COURIER}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{CP1252}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{32}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{piePagina}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{tituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{subtituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{subtituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{contenidoNormal}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{piePagina}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Configurar separadores visuales}
\PYG{+w}{            }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Event handler para encabezados y pies de página}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{finalBf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{finalColorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{setPageEvent}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPageEventHelper}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onEndPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{c+c1}{// Pie de página con numeración}
\PYG{+w}{                        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{finalBf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{fontPie}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{finalColorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                        }\PYG{n}{ColumnText}\PYG{p}{.}\PYG{n+na}{showTextAligned}\PYG{p}{(}\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getDirectContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }
\PYG{+w}{                            }\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{,}\PYG{+w}{ }
\PYG{+w}{                            }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s \PYGZpc{}d}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.pagina}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getPageNumber}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                            }\PYG{p}{(}\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{right}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{left}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{leftMargin}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }
\PYG{+w}{                            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{bottom}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{e}\PYG{p}{.}\PYG{n+na}{printStackTrace}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onStartPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Encabezado eliminado \PYGZhy{} no mostrar título en cada página}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{open}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }
\PYG{+w}{            }\PYG{c+c1}{// Determinar qué secciones estarán presentes}
\PYG{+w}{            }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{hasFuncionesError}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{funcionesError}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{hasTablaPredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// PÁGINA 1: PORTADA PROFESIONAL}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{crearPortadaProfesional}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// PÁGINA 2: ÍNDICE AUTOMÁTICO}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{crearIndiceSimulador}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hasFuncionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hasTablaPredictiva}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// CONTENIDO DETALLADO (SIN SECCIONES EXCLUIDAS)}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// SECCIÓN 1: GRAMÁTICA ORIGINAL}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloGramaticaOriginal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{1. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.gramatica.original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{toUpperCase}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloGramaticaOriginal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separadorSecundario}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Información básica}
\PYG{+w}{            }\PYG{n}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                      }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// SECCIÓN 2: GRAMÁTICA MODIFICADA}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloGramaticaModificada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{2. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.gramatica.modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{toUpperCase}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloGramaticaModificada}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separadorSecundario}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                      }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// SECCIÓN 3: FUNCIONES DE ERROR}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{funcionesError}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{funcionesError}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloFuncionesError}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{seccionNumero}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.funciones.error}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{toUpperCase}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloFuncionesError}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separadorSecundario}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{agregarFuncionesError}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}
\PYG{+w}{                                    }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// SECCIÓN 4: TABLA PREDICTIVA}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{tablaPredictiva}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloTablaPredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{seccionNumero}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{. }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.tabla.predictiva}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{toUpperCase}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloTablaPredictiva}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separadorSecundario}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{agregarTablaPredictivaMejorada}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                             }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// INFORMACIÓN FINAL \PYGZhy{} IDÉNTICA AL INFORME DE SIMULACIÓN}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Información adicional}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{infoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{infoAdicional}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.creditos}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{infoAdicional}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{infoAdicional}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{fechaConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.fecha}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{                }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{LocalDate}\PYG{p}{.}\PYG{n+na}{now}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{.}\PYG{n+na}{DateTimeFormatter}\PYG{p}{.}\PYG{n+na}{ofPattern}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{dd/MM/yyyy}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{fechaConclusion}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{fechaConclusion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{close}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{BadElementException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de elemento en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{IOException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de E/S en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error general en generación de PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Verifica si un símbolo es terminal}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{esTerminal}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{o}{!}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Construye el árbol sintáctico desde el historial de simulación}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n+nf}{construirArbolDesdeHistorial}\PYG{p}{(}\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historial}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Creamos la raíz con el símbolo inicial}
\PYG{+w}{        }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{raiz}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{NodoArbol}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Crear una copia del historial para no modificar el original}
\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialCopia}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{historial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{construirRecursivo}\PYG{p}{(}\PYG{n}{raiz}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialCopia}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{raiz}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Función recursiva para construir el árbol}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{construirRecursivo}\PYG{p}{(}\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{pasos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pasos}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Buscar la producción que expande este nodo}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{pasos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{HistorialPaso}\PYG{+w}{ }\PYG{n}{paso}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pasos}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{accion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getAccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Si es una producción (contiene una flecha)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Eliminar el número de producción si existe}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{accionLimpia}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{replaceAll}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZca{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{d+}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{.}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s*}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{accionLimpia}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{izquierda}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{derecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partes}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Si esta producción corresponde al nodo actual}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{izquierda}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Dividir la parte derecha en símbolos}
\PYG{+w}{                    }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{derecha}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{c+c1}{// Crear nodos hijos para cada símbolo}
\PYG{+w}{                    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{hijo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{NodoArbol}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{hijos}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{hijo}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                            }\PYG{c+c1}{// Si el hijo es no terminal, procesarlo recursivamente}
\PYG{+w}{                            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{esTerminal}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                                }\PYG{c+c1}{// Crear una nueva lista con los pasos restantes}
\PYG{+w}{                                }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{pasosRestantes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{pasos}\PYG{p}{.}\PYG{n+na}{subList}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{pasos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                                }\PYG{n}{construirRecursivo}\PYG{p}{(}\PYG{n}{hijo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{pasosRestantes}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{k}{break}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Solo procesar la primera producción que coincida}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Genera código DOT desde el árbol sintáctico}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{generarDotDesdeArbol}\PYG{p}{(}\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{raiz}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{sb}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{digraph G \PYGZob{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  node [shape=box, style=rounded, fontname=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{Arial}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{];}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  edge [arrowhead=none];}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Usar un contador para generar IDs únicos de nodos}
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{idCounter}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{generarDotRec}\PYG{p}{(}\PYG{n}{raiz}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{sb}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{idCounter}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZcb{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Función recursiva para generar código DOT}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{generarDotRec}\PYG{p}{(}\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{sb}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{id}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{parentId}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{myId}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{id}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{o}{+}\PYG{o}{+}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{myId}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ [label=}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{.}\PYG{n+na}{replace}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{];}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{parentId}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{sb}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{parentId}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{myId}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{;}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{hijo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{hijos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{generarDotRec}\PYG{p}{(}\PYG{n}{hijo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{sb}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{id}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{myId}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Genera la imagen del árbol sintáctico y la añade al PDF}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarImagenArbolAlPDF}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Verificar si hay historial disponible}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{historialPasos}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{c+c1}{// Construir el árbol desde el historial}
\PYG{+w}{            }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{raiz}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{construirArbolDesdeHistorial}\PYG{p}{(}\PYG{n}{historialPasos}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Generar código DOT}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{dotCode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{generarDotDesdeArbol}\PYG{p}{(}\PYG{n}{raiz}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Crear archivos temporales}
\PYG{+w}{            }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Path}\PYG{+w}{ }\PYG{n}{dotFile}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{createTempFile}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{arbol\PYGZus{}pdf\PYGZus{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.dot}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Path}\PYG{+w}{ }\PYG{n}{imgFile}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{createTempFile}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{arbol\PYGZus{}pdf\PYGZus{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{.png}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Escribir código DOT al archivo}
\PYG{+w}{                }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{write}\PYG{p}{(}\PYG{n}{dotFile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dotCode}\PYG{p}{.}\PYG{n+na}{getBytes}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Ejecutar Graphviz para generar la imagen}
\PYG{+w}{                }\PYG{n}{ProcessBuilder}\PYG{+w}{ }\PYG{n}{pb}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ProcessBuilder}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{dot}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}Tpng}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dotFile}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}o}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{imgFile}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Process}\PYG{+w}{ }\PYG{n}{process}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pb}\PYG{p}{.}\PYG{n+na}{start}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{exitCode}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{process}\PYG{p}{.}\PYG{n+na}{waitFor}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{exitCode}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{exists}\PYG{p}{(}\PYG{n}{imgFile}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Crear imagen para el PDF usando iText}
\PYG{+w}{                    }\PYG{n}{com}\PYG{p}{.}\PYG{n+na}{itextpdf}\PYG{p}{.}\PYG{n+na}{text}\PYG{p}{.}\PYG{n+na}{Image}\PYG{+w}{ }\PYG{n}{imagenArbol}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{com}\PYG{p}{.}\PYG{n+na}{itextpdf}\PYG{p}{.}\PYG{n+na}{text}\PYG{p}{.}\PYG{n+na}{Image}\PYG{p}{.}\PYG{n+na}{getInstance}\PYG{p}{(}\PYG{n}{imgFile}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{c+c1}{// Configurar la imagen para que quepa en el PDF}
\PYG{+w}{                    }\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{maxWidth}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{getPageSize}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getWidth}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{leftMargin}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{rightMargin}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{maxHeight}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Altura máxima fija}

\PYG{+w}{                    }\PYG{c+c1}{// Calcular escala para ajustar la imagen}
\PYG{+w}{                    }\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{scaleX}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{maxWidth}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{n}{imagenArbol}\PYG{p}{.}\PYG{n+na}{getWidth}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{scaleY}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{maxHeight}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{n}{imagenArbol}\PYG{p}{.}\PYG{n+na}{getHeight}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{scale}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Math}\PYG{p}{.}\PYG{n+na}{min}\PYG{p}{(}\PYG{n}{scaleX}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{scaleY}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{n}{imagenArbol}\PYG{p}{.}\PYG{n+na}{scalePercent}\PYG{p}{(}\PYG{n}{scale}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{c+c1}{// Centrar la imagen}
\PYG{+w}{                    }\PYG{n}{imagenArbol}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{com}\PYG{p}{.}\PYG{n+na}{itextpdf}\PYG{p}{.}\PYG{n+na}{text}\PYG{p}{.}\PYG{n+na}{Image}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{c+c1}{// Añadir la imagen al documento}
\PYG{+w}{                    }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{imagenArbol}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{finally}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Limpiar archivos temporales}
\PYG{+w}{                }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{deleteIfExists}\PYG{p}{(}\PYG{n}{dotFile}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{nio}\PYG{p}{.}\PYG{n+na}{file}\PYG{p}{.}\PYG{n+na}{Files}\PYG{p}{.}\PYG{n+na}{deleteIfExists}\PYG{p}{(}\PYG{n}{imgFile}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Ignorar errores al limpiar archivos temporales}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Si hay algún error (GraphViz no disponible, etc.), simplemente no añadir la imagen}
\PYG{+w}{            }\PYG{c+c1}{// Esto es mejor que fallar toda la generación del PDF}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{WARNING}\PYG{p}{,}
\PYG{+w}{                }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{No se pudo generar la imagen del árbol sintáctico: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{.}\PYG{n+na}{getMessage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Genera un informe PDF profesional y visualmente atractivo de la simulación}
\PYG{c+cm}{     * Incluye portada, índice, resumen ejecutivo, y contenido formateado con colores y estilos}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Boolean}\PYG{+w}{ }\PYG{n+nf}{generarInformeSimulacionFinalProfesional}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fichero}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{FuncionError}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Configuración inicial del documento}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{fontPath}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{fonts/arial.ttf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Document}\PYG{p}{(}\PYG{n}{PageSize}\PYG{p}{.}\PYG{n+na}{A4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Crear el PdfWriter con gestión avanzada de páginas}
\PYG{+w}{            }\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{PdfWriter}\PYG{p}{.}\PYG{n+na}{getInstance}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{FileOutputStream}\PYG{p}{(}\PYG{n}{fichero}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Configurar esquema de colores profesional}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{41}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{128}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{185}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{     }\PYG{c+c1}{// Azul profesional}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{52}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{152}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{219}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{   }\PYG{c+c1}{// Azul claro}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{230}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{126}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{34}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c+c1}{// Naranja}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{46}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{204}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{113}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{        }\PYG{c+c1}{// Verde éxito}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorError}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{231}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{         }\PYG{c+c1}{// Rojo error}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{149}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{165}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{166}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{      }\PYG{c+c1}{// Gris neutro}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{236}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{241}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Gris muy claro}

\PYG{+w}{            }\PYG{c+c1}{// Fuentes tipográficas profesionales}
\PYG{+w}{            }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{fontPath}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{IDENTITY\PYGZus{}H}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{createFont}\PYG{p}{(}\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{COURIER}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{CP1252}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{p}{.}\PYG{n+na}{EMBEDDED}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{32}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{piePagina}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{tituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{subtituloPortada}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{subtituloSeccion}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{contenidoNormal}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{piePagina}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Configurar separadores visuales}
\PYG{+w}{            }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorPrincipal}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{separadorSecundario}\PYG{p}{.}\PYG{n+na}{setLineColor}\PYG{p}{(}\PYG{n}{colorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Event handler para encabezados y pies de página}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{finalBf}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{;}
\PYG{+w}{            }\PYG{k+kd}{final}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{finalColorNeutro}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorNeutro}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{setPageEvent}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPageEventHelper}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onEndPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{c+c1}{// Pie de página con numeración}
\PYG{+w}{                        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{finalBf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{ITALIC}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{n}{fontPie}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{finalColorNeutro}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                        }\PYG{n}{ColumnText}\PYG{p}{.}\PYG{n+na}{showTextAligned}\PYG{p}{(}\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getDirectContent}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                            }\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{,}
\PYG{+w}{                            }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s \PYGZpc{}d}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{finalBundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.pagina}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{.}\PYG{n+na}{getPageNumber}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fontPie}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                            }\PYG{p}{(}\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{right}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{left}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{leftMargin}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{                            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{bottom}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{e}\PYG{p}{.}\PYG{n+na}{printStackTrace}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{n+nd}{@Override}
\PYG{+w}{                }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{onStartPage}\PYG{p}{(}\PYG{n}{PdfWriter}\PYG{+w}{ }\PYG{n}{writer}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{c+c1}{// Encabezado eliminado \PYGZhy{} no mostrar título en cada página}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{open}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// PÁGINA 1: PORTADA PROFESIONAL}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{crearPortadaProfesional}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorPrincipal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// PÁGINA 2: ÍNDICE AUTOMÁTICO}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{crearIndiceAutomatico}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// PÁGINA 3: RESUMEN EJECUTIVO}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{crearResumenEjecutivo}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                }\PYG{n}{separadorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// CONTENIDO DETALLADO}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{crearContenidoDetallado}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{contenidoMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{separadorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{tablaPredictiva}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{historialPasos}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{c+c1}{// CONCLUSIÓN AUTOMÁTICA}
\PYG{+w}{            }\PYG{c+c1}{// ========================================}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{crearConclusionAutomatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                    }\PYG{n}{separadorPrincipal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{close}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{BadElementException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de elemento en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{IOException}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error de E/S en PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Logger}\PYG{p}{.}\PYG{n+na}{getLogger}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{log}\PYG{p}{(}\PYG{n}{Level}\PYG{p}{.}\PYG{n+na}{SEVERE}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error general en generación de PDF}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ex}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea la portada profesional del informe}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearPortadaProfesional}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloPortada}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}
\PYG{+w}{                                       }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{IOException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{c+c1}{// Logo de la aplicación}
\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Image}\PYG{+w}{ }\PYG{n}{logo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{Image}\PYG{p}{.}\PYG{n+na}{getInstance}\PYG{p}{(}\PYG{n}{Objects}\PYG{p}{.}\PYG{n+na}{requireNonNull}\PYG{p}{(}\PYG{n}{getClass}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getResource}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{/resources/logo2Antes.png}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{toExternalForm}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{logo}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Image}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{logo}\PYG{p}{.}\PYG{n+na}{scalePercent}\PYG{p}{(}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{logo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Si no hay logo, continuar sin él}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Espacios}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Título principal grande}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloPrincipal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.portada.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloPortada}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloPrincipal}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloPrincipal}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Subtítulo con nombre de la gramática}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloGramatica}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{22}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{subtituloGramatica}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subtitulo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloGramatica}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{subtitulo}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subtitulo}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Información adicional}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{infoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{appInfo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.portada.app.nombre}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{appInfo}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{appInfo}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Fecha de generación}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{fechaFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fechaFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{fecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.generado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{            }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{LocalDate}\PYG{p}{.}\PYG{n+na}{now}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{.}\PYG{n+na}{DateTimeFormatter}\PYG{p}{.}\PYG{n+na}{ofPattern}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{dd/MM/yyyy}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fechaFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fecha}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{fecha}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea el índice automático del informe}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearIndiceAutomatico}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloIndice}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloIndice}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloIndice}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Estructura del índice}
\PYG{+w}{        }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{secciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.resumen}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.gramatica.original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.gramatica.modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.funciones.error}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.tabla.predictiva}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.historial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.derivacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.arbol}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{            }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.conclusion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{secciones}\PYG{p}{.}\PYG{n+na}{length}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{entrada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d. \PYGZpc{}s}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{secciones}\PYG{o}{[}\PYG{n}{i}\PYG{o}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{itemIndice}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{entrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{itemIndice}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{itemIndice}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea el índice automático específico para el informe del simulador}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearIndiceSimulador}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                    }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{hasFuncionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{hasTablaPredictiva}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloIndice}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloIndice}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloIndice}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección 1: Gramática Original (siempre presente)}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{entrada1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d. \PYGZpc{}s}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.gramatica.original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{itemIndice1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{entrada1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{itemIndice1}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{itemIndice1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección 2: Gramática Modificada (siempre presente)}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{entrada2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d. \PYGZpc{}s}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.gramatica.modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{itemIndice2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{entrada2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{itemIndice2}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{itemIndice2}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Sección 3: Funciones de Error (solo si existen)}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{hasFuncionesError}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{entrada3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d. \PYGZpc{}s}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.funciones.error}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{itemIndice3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{entrada3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{itemIndice3}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{itemIndice3}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Sección 4: Tabla Predictiva (última sección si existe)}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{hasTablaPredictiva}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{entrada4}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d. \PYGZpc{}s}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{seccionNumero}\PYG{o}{+}\PYG{o}{+}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.indice.tabla.predictiva}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{itemIndice4}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{entrada4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{itemIndice4}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{itemIndice4}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea el resumen ejecutivo del informe}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearResumenEjecutivo}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}
\PYG{+w}{                                     }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloResumen}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.resumen.ejecutivo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloResumen}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloResumen}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Información clave}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{labelFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{labelFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Cadena de entrada}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{labelCadena}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.cadena.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{labelFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{labelCadena}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{valorFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{valorCadena}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{cadenaEntrada}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.no.especificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{valorFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{valorCadena}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{valorCadena}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Resultado final con recuadro destacado}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{labelResultado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.resultado.final}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{labelFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{labelResultado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorEstado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.estado.aceptada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}
\PYG{+w}{                               }\PYG{n}{colorExito}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{textoEstado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.no.especificado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Crear tabla para resaltar el resultado}
\PYG{+w}{        }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaResultado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaResultado}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{80}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaResultado}\PYG{p}{.}\PYG{n+na}{setSpacingBefore}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaResultado}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{estadoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{estadoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorEstado}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellResultado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{textoEstado}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Fondo gris muy claro}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorEstado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellResultado}\PYG{p}{.}\PYG{n+na}{setVerticalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}MIDDLE}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{tablaResultado}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellResultado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaResultado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Número de pasos}
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{numPasos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{labelPasos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.numero.pasos}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{labelFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{labelPasos}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{valorPasos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{numPasos}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.unidad.pasos}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{valorFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{valorPasos}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{valorPasos}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea el contenido detallado del informe}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearContenidoDetallado}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{FuncionError}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{,}
\PYG{+w}{                                       }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{)}
\PYG{+w}{                                       }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 1: GRAMÁTICA ORIGINAL}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloGramaticaOriginal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.gramatica.original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloGramaticaOriginal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Información básica}
\PYG{+w}{        }\PYG{n}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{gramaticaOriginal}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{original}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 2: GRAMÁTICA MODIFICADA}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloGramaticaModificada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.gramatica.modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloGramaticaModificada}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                  }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{modificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 3: FUNCIONES DE ERROR}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{funcionesError}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{funcionesError}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloFuncionesError}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.funciones.error}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloFuncionesError}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{agregarFuncionesError}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}
\PYG{+w}{                                }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 4: TABLA PREDICTIVA}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{tablaPredictiva}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloTablaPredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.tabla.predictiva}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloTablaPredictiva}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{agregarTablaPredictivaMejorada}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 5: INFORMACIÓN DE SIMULACIÓN}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloSimulacion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.simulacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloSimulacion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{agregarInformacionSimulacion}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}
\PYG{+w}{                                   }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 6: HISTORIAL DE PASOS}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{historialPasos}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloHistorial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.historial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloHistorial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{agregarHistorialMejorado}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}
\PYG{+w}{                                   }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorFondoCabecera}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 7: DERIVACIÓN}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{historialPasos}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloDerivacion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.derivacion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloDerivacion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{agregarDerivacionMejorada}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{c+c1}{// SECCIÓN 8: ÁRBOL SINTÁCTICO}
\PYG{+w}{        }\PYG{c+c1}{// ========================================}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{newPage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloArbol}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.seccion.arbol}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloArbol}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{agregarArbolSintacticoMejorado}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega información detallada de una gramática con formato mejorado}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarInformacionGramatica}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                           }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{,}
\PYG{+w}{                                           }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{tipo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{)}
\PYG{+w}{                                           }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{c+c1}{// Descripción}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subDesc}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.descripcion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subDesc}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{desc}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getDescripcion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{desc}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{desc}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Símbolo inicial}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.simbolo.inicial}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subSimbolo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{simboloFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Símbolos no terminales}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subNoTerm}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.simbolos.no.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subNoTerm}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{noTerm}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{ntFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{ntFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{ntPara}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    • }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ntFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{ntPara}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{ntPara}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Símbolos terminales}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subTerm}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.simbolos.terminales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subTerm}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{termFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{termFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{termPara}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    • }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{termFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{termPara}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{termPara}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Producciones}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subProd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.producciones}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subProd}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{prod}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{gramatica}\PYG{p}{.}\PYG{n+na}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{index}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{prod}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Crear tabla para producción con formato simplificado}
\PYG{+w}{            }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaProd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaProd}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{95}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaProd}\PYG{p}{.}\PYG{n+na}{setWidths}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{k+kt}{float}\PYG{o}{[}\PYG{o}{]}\PYG{p}{\PYGZob{}}\PYG{l+m+mf}{0.15f}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.85f}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Proporciones: número, producción completa}

\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{numeroFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{numeroFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{prodFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{contenidoMono}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{prodFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Convertir la flecha Unicode a ASCII solo para el PDF}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionFormateada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccion}\PYG{p}{.}\PYG{n+na}{replace}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Celda del número}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellNumero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{valueOf}\PYG{p}{(}\PYG{n}{index}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{numeroFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Azul muy claro}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellNumero}\PYG{p}{.}\PYG{n+na}{setVerticalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}MIDDLE}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaProd}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellNumero}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Celda de la producción completa}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellProd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{produccionFormateada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{prodFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{249}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Gris muy claro}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellProd}\PYG{p}{.}\PYG{n+na}{setVerticalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}MIDDLE}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaProd}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellProd}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaProd}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{index}\PYG{o}{+}\PYG{o}{+}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega sección de funciones de error con formato tabular mejorado}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarFuncionesError}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{FuncionError}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}
\PYG{+w}{                                     }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{)}
\PYG{+w}{                                     }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaFunciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{setSpacingBefore}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{setWidths}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{k+kt}{float}\PYG{o}{[}\PYG{o}{]}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Fuentes}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{headerFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Encabezados}
\PYG{+w}{        }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{headers}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ID}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Acción}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Símbolo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Descripción}\PYG{l+s}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{header}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{headers}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cell}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{header}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Datos}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{FuncionError}\PYG{+w}{ }\PYG{n}{funcion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{funcionesError}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoFila}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// ID}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellId}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{valueOf}\PYG{p}{(}\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getIdentificador}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellId}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellId}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellId}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellId}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellId}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellId}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Acción}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombreAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getNombreAccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{accionFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorAcento}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{nombreAccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{accionFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellAccion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Símbolo}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getSimbolo}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getSimbolo}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{simboloFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getSimbolo}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellSimbolo}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Descripción completa}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{descripcion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getDescripcionFuncionError}\PYG{p}{(}\PYG{n}{funcion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getMensaje}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getMensaje}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{descripcion}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ (}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{funcion}\PYG{p}{.}\PYG{n+na}{getMensaje}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{)}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellDescripcion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{descripcion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellDescripcion}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellDescripcion}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellDescripcion}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellDescripcion}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellDescripcion}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaFunciones}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellDescripcion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{filaAlterna}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaFunciones}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega tabla predictiva con mejor formato visual}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarTablaPredictivaMejorada}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{,}
\PYG{+w}{                                              }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenido}\PYG{p}{,}
\PYG{+w}{                                              }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{p}{)}
\PYG{+w}{                                              }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{FilaTablaPredictiva}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{filas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{tablaPredictiva}\PYG{p}{.}\PYG{n+na}{getFilas}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{filas}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{n}{filas}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{return}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{terminales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{terminales}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{return}\PYG{p}{;}

\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{numColumnas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{terminales}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tabla}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{n}{numColumnas}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{setSpacingBefore}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Fuentes para la tabla}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{headerFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Encabezado de símbolo}
\PYG{+w}{        }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.tabla.simbolo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellSimbolo}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellSimbolo}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Encabezados de terminales}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{terminal}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{terminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellTerm}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellTerm}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellTerm}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellTerm}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellTerm}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellTerm}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellTerm}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Filas de datos}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{FilaTablaPredictiva}\PYG{+w}{ }\PYG{n}{fila}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{filas}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoFila}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Celda del símbolo}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fila}\PYG{p}{.}\PYG{n+na}{getSimbolo}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fila}\PYG{p}{.}\PYG{n+na}{getEsTerminal}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{NORMAL}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{simboloFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{fila}\PYG{p}{.}\PYG{n+na}{getEsTerminal}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellSim}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{simboloFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSim}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSim}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSim}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSim}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellSim}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellSim}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Celdas de valores}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{terminal}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{terminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{valor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fila}\PYG{p}{.}\PYG{n+na}{getValor}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{textoCelda}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{valor}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{valor}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{valor}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{valorFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoValor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorFondoFila}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Colores específicos según tipo de contenido}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{textoCelda}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{valorFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Verde para producciones}
\PYG{+w}{                    }\PYG{n}{colorFondoValor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Verde muy claro}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{textoCelda}\PYG{p}{.}\PYG{n+na}{startsWith}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{valorFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{140}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Naranja para épsilon}
\PYG{+w}{                    }\PYG{n}{colorFondoValor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Naranja muy claro}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{textoCelda}\PYG{p}{.}\PYG{n+na}{matches}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{d+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{valorFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Azul para funciones error}
\PYG{+w}{                    }\PYG{n}{colorFondoValor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Azul muy claro}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellValor}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{textoCelda}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{valorFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{cellValor}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoValor}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{cellValor}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{cellValor}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{cellValor}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{cellValor}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{tabla}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellValor}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{filaAlterna}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tabla}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega información de simulación mejorada}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarInformacionSimulacion}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                            }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}
\PYG{+w}{                                            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{c+c1}{// Cadena de entrada}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subCadena}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.cadena.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subCadena}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{cadenaFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cadenaFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{cadena}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{cadenaEntrada}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{cadenaEntrada}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.no.especificada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cadenaFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cadena}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{cadena}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Estado final destacado}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{subEstado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.resultado.final}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{subtituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{subEstado}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorEstado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.estado.aceptada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}
\PYG{+w}{                               }\PYG{n}{colorExito}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{estadoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{estadoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorEstado}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{estado}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.no.especificado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{estadoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{estado}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{estado}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{estado}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega historial de pasos mejorado con colores}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarHistorialMejorado}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}
\PYG{+w}{                                        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{,}
\PYG{+w}{                                        }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorSecundario}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorAcento}\PYG{p}{)}
\PYG{+w}{                                        }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaHistorial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{setSpacingBefore}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{setWidths}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{k+kt}{float}\PYG{o}{[}\PYG{o}{]}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Fuentes}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{headerFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Encabezados usando las claves correctas del bundle}
\PYG{+w}{        }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{headerKeys}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{paso}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{accion}\PYG{l+s}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{key}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{headerKeys}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cell}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.historial.}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{key}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{headerFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cell}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Datos con colores diferenciados}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{HistorialPaso}\PYG{+w}{ }\PYG{n}{paso}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoFila}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{n}{colorFondo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{WHITE}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Paso}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellPaso}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getPaso}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellPaso}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Pila}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellPila}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getPila}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPila}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPila}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPila}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPila}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPila}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellPila}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Entrada}
\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellEntrada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getEntrada}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{dataFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellEntrada}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoFila}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellEntrada}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellEntrada}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellEntrada}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellEntrada}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellEntrada}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Acción con colores diferenciados}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{accionOriginal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getAccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{c+c1}{// Convertir flechas Unicode a ASCII para mostrar en el PDF}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{accion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{accionOriginal}\PYG{p}{.}\PYG{n+na}{replace}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{accionFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorFondoAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorFondoFila}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Emparejar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{52}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{152}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{219}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Azul para emparejar}
\PYG{+w}{                }\PYG{n}{colorFondoAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{46}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{204}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{113}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Verde para derivaciones}
\PYG{+w}{                }\PYG{n}{colorFondoAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Error}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{231}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Rojo para errores}
\PYG{+w}{                }\PYG{n}{colorFondoAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Aceptar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{230}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{126}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{34}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Naranja para aceptar}
\PYG{+w}{                }\PYG{n}{accionFont}\PYG{p}{.}\PYG{n+na}{setStyle}\PYG{p}{(}\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{colorFondoAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{255}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellAccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{accion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{accionFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{n}{colorFondoAccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}LEFT}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorSecundario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellAccion}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mf}{0.5f}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaHistorial}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellAccion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{filaAlterna}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{filaAlterna}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaHistorial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega derivación con formato de código}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarDerivacionMejorada}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{11}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{HistorialPaso}\PYG{+w}{ }\PYG{n}{paso}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{c+c1}{// Convertir flechas Unicode a ASCII para mostrar en el PDF}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{accionFormateada}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{paso}\PYG{p}{.}\PYG{n+na}{getAccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{replace}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{→}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{derivacionLine}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.derivacion.paso}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{accionFormateada}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Crear bloque para cada paso}
\PYG{+w}{            }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaPaso}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{tablaPaso}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{95}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellPaso}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{derivacionLine}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoMono}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{248}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{249}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{cellPaso}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{n}{tablaPaso}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellPaso}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaPaso}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bfMono}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega árbol sintáctico con colores diferenciados}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarArbolSintacticoMejorado}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                               }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{HistorialPaso}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{,}
\PYG{+w}{                                               }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{k}{try}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{agregarImagenArbolAlPDF}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{historialPasos}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{catch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Exception}\PYG{+w}{ }\PYG{n}{e}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Si no se puede generar la imagen, mostrar información textual con colores}
\PYG{+w}{            }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{notaArbol}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Árbol Sintáctico (Vista Textual):}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{notaArbol}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Crear representación textual coloreada}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{historialPasos}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{historialPasos}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{raiz}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{construirArbolDesdeHistorial}\PYG{p}{(}\PYG{n}{historialPasos}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{agregarRepresentacionArbolTextual}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{raiz}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Agrega representación textual del árbol con colores}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{agregarRepresentacionArbolTextual}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{,}
\PYG{+w}{                                                 }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prefijo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{nodoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{esTerminal}\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{nodoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{BLACK}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Terminales en negro}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{nodoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// No terminales en azul}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simboloEspecial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdl{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{;}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{nodoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Símbolos especiales en gris}
\PYG{+w}{            }\PYG{n}{simboloEspecial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ (}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{)}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{nodoPara}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{prefijo}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{├── }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{valor}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{simboloEspecial}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nodoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{nodoPara}\PYG{p}{.}\PYG{n+na}{setIndentationLeft}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{prefijo}\PYG{p}{.}\PYG{n+na}{length}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nodoPara}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Procesar hijos recursivamente}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{hijos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{NodoArbol}\PYG{+w}{ }\PYG{n}{hijo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{hijos}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nuevoPrefijo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{prefijo}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nodo}\PYG{p}{.}\PYG{n+na}{hijos}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{│   }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{    }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{agregarRepresentacionArbolTextual}\PYG{p}{(}\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hijo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nuevoPrefijo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{colorPrimario}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Crea la conclusión automática del informe}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{crearConclusionAutomatica}\PYG{p}{(}\PYG{n}{Document}\PYG{+w}{ }\PYG{n}{document}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseFont}\PYG{+w}{ }\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{contenidoNormal}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{LineSeparator}\PYG{+w}{ }\PYG{n}{separador}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{,}
\PYG{+w}{                                         }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{throws}\PYG{+w}{ }\PYG{n}{DocumentException}\PYG{+w}{ }\PYG{p}{\PYGZob{}}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{tituloConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.titulo}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{tituloSeccion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tituloConclusion}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tituloConclusion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Chunk}\PYG{p}{(}\PYG{n}{separador}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Conclusión automática basada en el estado}
\PYG{+w}{        }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{conclusion}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{BaseColor}\PYG{+w}{ }\PYG{n}{colorConclusion}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{conclusionFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{.}\PYG{n+na}{BOLD}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.estado.aceptada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{conclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.aceptada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{colorConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorExito}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{estadoSimulacion}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{estadoSimulacion}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.simulador.estado.rechazada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{conclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.rechazada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{colorConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{colorError}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{conclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.no.determinado}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{colorConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{conclusionFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{colorConclusion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Crear tabla para resaltar la conclusión}
\PYG{+w}{        }\PYG{n}{PdfPTable}\PYG{+w}{ }\PYG{n}{tablaConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPTable}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaConclusion}\PYG{p}{.}\PYG{n+na}{setWidthPercentage}\PYG{p}{(}\PYG{l+m+mi}{85}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaConclusion}\PYG{p}{.}\PYG{n+na}{setSpacingBefore}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{tablaConclusion}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{PdfPCell}\PYG{+w}{ }\PYG{n}{cellConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{PdfPCell}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Phrase}\PYG{p}{(}\PYG{n}{conclusion}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{conclusionFont}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setBackgroundColor}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{BaseColor}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Fondo gris muy claro}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setBorderColor}\PYG{p}{(}\PYG{n}{colorConclusion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setBorderWidth}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setPadding}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setHorizontalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{cellConclusion}\PYG{p}{.}\PYG{n+na}{setVerticalAlignment}\PYG{p}{(}\PYG{n}{PdfPCell}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}MIDDLE}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{tablaConclusion}\PYG{p}{.}\PYG{n+na}{addCell}\PYG{p}{(}\PYG{n}{cellConclusion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{tablaConclusion}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Información adicional}
\PYG{+w}{        }\PYG{n}{Font}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Font}\PYG{p}{(}\PYG{n}{bf}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{infoFont}\PYG{p}{.}\PYG{n+na}{setColor}\PYG{p}{(}\PYG{n}{BaseColor}\PYG{p}{.}\PYG{n+na}{GRAY}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{infoAdicional}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.conclusion.creditos}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{infoAdicional}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{infoAdicional}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Paragraph}\PYG{+w}{ }\PYG{n}{fechaConclusion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Paragraph}\PYG{p}{(}\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{informe.profesional.fecha}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}
\PYG{+w}{            }\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{LocalDate}\PYG{p}{.}\PYG{n+na}{now}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{(}\PYG{n}{java}\PYG{p}{.}\PYG{n+na}{time}\PYG{p}{.}\PYG{n+na}{format}\PYG{p}{.}\PYG{n+na}{DateTimeFormatter}\PYG{p}{.}\PYG{n+na}{ofPattern}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{dd/MM/yyyy}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{infoFont}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{fechaConclusion}\PYG{p}{.}\PYG{n+na}{setAlignment}\PYG{p}{(}\PYG{n}{Paragraph}\PYG{p}{.}\PYG{n+na}{ALIGN\PYGZus{}CENTER}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{document}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{fechaConclusion}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{isNoTerminal}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNoTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{isTerminal}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombre}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nombre}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{copiarDesde}\PYG{p}{(}\PYG{n}{Gramatica}\PYG{+w}{ }\PYG{n}{otra}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{nombre}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{descripcion}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getDescripcion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{simbInicial}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{estado}\PYG{p}{.}\PYG{n+na}{set}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getEstado}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerm}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{term}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{producciones}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getNoTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{pr}\PYG{p}{.}\PYG{n+na}{setAll}\PYG{p}{(}\PYG{n}{otra}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{modificarSimboloProduccion}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simboloAntiguo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nuevoSimbolo}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{produccion}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{produccion}\PYG{p}{.}\PYG{n+na}{modificarSimbolo}\PYG{p}{(}\PYG{n}{simboloAntiguo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nuevoSimbolo}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{//SIMULACION}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{generarTPredictiva}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Si ya existe una tabla predictiva, limpiarla}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{tpredictiva}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{tpredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{c+c1}{// Crear una nueva tabla predictiva}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{tpredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n+nf}{getTPredictiva}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{tpredictiva}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{setTPredictiva}\PYG{p}{(}\PYG{n}{TablaPredictiva}\PYG{+w}{ }\PYG{n}{tabla}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{tpredictiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{tabla}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Verifica si la gramática tiene recursividad por la izquierda y la elimina.}
\PYG{c+cm}{     *}
\PYG{c+cm}{     * @return true si la gramática tenía recursividad y fue modificada, false si ya estaba correcta.}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{eliminarRecursividad}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{esRecursiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesOriginales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesModificadas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerminalesModificados}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{produccionesOriginales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{c+c1}{// Dividir por la flecha \PYGZdq{}→\PYGZdq{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partesFlecha}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{produccionStr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{continue}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Dividir el consecuente por espacios para obtener los símbolos}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{c+c1}{// Verificar recursividad por la izquierda}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{simbolos}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{esRecursiva}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nuevoNoTerminal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}

\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{noTerminalesModificados}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{noTerminalesModificados}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{c+c1}{// Nueva producción sin recursividad}
\PYG{+w}{                }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{nuevaProduccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ →}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Agregar todos los símbolos después del primero}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{simbolos}\PYG{o}{[}\PYG{n}{i}\PYG{o}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{c+c1}{// Agregar el nuevo no terminal}
\PYG{+w}{                }\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Agregar la nueva producción con ε}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{produccionStr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{esRecursiva}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setNoTerminalesModel}\PYG{p}{(}\PYG{n}{noTerminalesModificados}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setProduccionesModel}\PYG{p}{(}\PYG{n}{produccionesModificadas}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{esRecursiva}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Verifica si la gramática requiere factorización y la realiza si es necesario.}
\PYG{c+cm}{     *}
\PYG{c+cm}{     * @return true si la gramática fue factorizada, false si ya estaba correcta.}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{factorizar}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{necesitaFactorizacion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesOriginales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesModificadas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{noTerminales}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getNoTerminalesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{gruposProducciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashMap}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Agrupar producciones por antecedente y primer símbolo}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{produccionesOriginales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partesFlecha}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{continue}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{clave}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{gruposProducciones}\PYG{p}{.}\PYG{n+na}{putIfAbsent}\PYG{p}{(}\PYG{n}{clave}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{gruposProducciones}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{clave}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{produccionStr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Procesar cada grupo}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Map}\PYG{p}{.}\PYG{n+na}{Entry}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{grupo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{gruposProducciones}\PYG{p}{.}\PYG{n+na}{entrySet}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{listaProducciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{grupo}\PYG{p}{.}\PYG{n+na}{getValue}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{listaProducciones}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// Hay factor común}
\PYG{+w}{                }\PYG{n}{necesitaFactorizacion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Extraer antecedente del primer grupo}
\PYG{+w}{                }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesPrimera}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{listaProducciones}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesPrimera}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuentePrimera}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesPrimera}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolosPrimera}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuentePrimera}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{simbolosPrimera}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{;}

\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nuevoNoTerminal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}

\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{noTerminales}\PYG{p}{.}\PYG{n+na}{contains}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{noTerminales}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                }\PYG{c+c1}{// Nueva producción con factor común extraído}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{nuevoNoTerminal}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Crear producciones para el nuevo no terminal}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{listaProducciones}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{n}{StringBuilder}\PYG{+w}{ }\PYG{n}{nuevaProduccion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{StringBuilder}\PYG{p}{(}\PYG{n}{nuevoNoTerminal}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ →}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                    }\PYG{c+c1}{// Agregar todos los símbolos después del primer símbolo (el factor común)}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{n}{simbolos}\PYG{o}{[}\PYG{n}{i}\PYG{o}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{append}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                    }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{nuevaProduccion}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Si no hay factorización, agregar la producción original}
\PYG{+w}{                }\PYG{n}{produccionesModificadas}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{listaProducciones}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{necesitaFactorizacion}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setNoTerminalesModel}\PYG{p}{(}\PYG{n}{noTerminales}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{setProduccionesModel}\PYG{p}{(}\PYG{n}{produccionesModificadas}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{necesitaFactorizacion}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Verifica si la gramática tiene recursividad por la izquierda sin modificarla}
\PYG{c+cm}{     * @return true si tiene recursividad por la izquierda}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{verificarRecursividadSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{producciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{producciones}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partesFlecha}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{continue}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{simbolos}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Encontró recursividad por la izquierda}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Verifica si la gramática necesita factorización sin modificarla}
\PYG{c+cm}{     * @return true si necesita factorización}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{verificarFactorizacionSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesPorPrefijo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashMap}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{producciones}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{producciones}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{produccionStr}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ → }\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{partesFlecha}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{continue}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}

\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{partesFlecha}\PYG{o}{[}\PYG{l+m+mi}{1}\PYG{o}{]}\PYG{p}{.}\PYG{n+na}{trim}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{String}\PYG{o}{[}\PYG{o}{]}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{split}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}\PYGZbs{}}\PYG{l+s}{s+}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolos}\PYG{p}{.}\PYG{n+na}{length}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{simbolos}\PYG{o}{[}\PYG{l+m+mi}{0}\PYG{o}{]}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// Agrupar producciones por antecedente y primer símbolo}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{clave}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}\PYGZgt{}}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{produccionesPorPrefijo}\PYG{p}{.}\PYG{n+na}{computeIfAbsent}\PYG{p}{(}\PYG{n}{clave}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{k}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{produccionStr}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Verificar si algún prefijo tiene más de una producción}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{produccionesGrupo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{produccionesPorPrefijo}\PYG{p}{.}\PYG{n+na}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{produccionesGrupo}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Necesita factorización}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}


\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Método para probar y demostrar el proceso completo de transformación de gramáticas}
\PYG{c+cm}{     * para análisis descendente predictivo}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{demostrarTransformaciones}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{=== DEMOSTRACIÓN DE TRANSFORMACIONES PARA ANÁLISIS DESCENDENTE ===}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Gramática original:}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prod}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{prod}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Verificar estado inicial}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{tieneRecursividadInicial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{verificarRecursividadSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{necesitaFactorizacionInicial}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{verificarFactorizacionSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nEstado inicial:}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  \PYGZhy{} Tiene recursividad por la izquierda: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tieneRecursividadInicial}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  \PYGZhy{} Necesita factorización: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{necesitaFactorizacionInicial}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Paso 1: Eliminar recursividad por la izquierda}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{seEliminoRecursividad}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{eliminarRecursividad}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nDespués de eliminar recursividad:}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{seEliminoRecursividad}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  ✅ Recursividad eliminada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prod}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{prod}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  ℹ️  No había recursividad que eliminar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Paso 2: Factorizar si es necesario}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{seFactorizo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{factorizar}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nDespués de factorización:}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{seFactorizo}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  ✅ Factorización aplicada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{prod}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{getProduccionesModel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{prod}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  ℹ️  No era necesaria la factorización}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Verificar estado final}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{tieneRecursividadFinal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{verificarRecursividadSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{necesitaFactorizacionFinal}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{verificarFactorizacionSinModificar}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{nEstado final:}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  \PYGZhy{} Tiene recursividad por la izquierda: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tieneRecursividadFinal}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{  \PYGZhy{} Necesita factorización: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{necesitaFactorizacionFinal}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{tieneRecursividadFinal}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{o}{!}\PYG{n}{necesitaFactorizacionFinal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n🎉 ¡GRAMÁTICA LISTA PARA ANÁLISIS DESCENDENTE PREDICTIVO!}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n⚠️  La gramática aún necesita transformaciones adicionales}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{n}{System}\PYG{p}{.}\PYG{n+na}{out}\PYG{p}{.}\PYG{n+na}{println}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{=================================================================}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{generarConjPrim}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{primeros}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashMap}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{dependencias}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashMap}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Inicializar conjuntos primeros para cada no terminal}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{put}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashSet}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Primer recorrido: agregar terminales y épsilon directamente}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{primero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primero}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{u03b5}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{u03b5}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{isTerminal}\PYG{p}{(}\PYG{n}{primero}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{primero}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{dependencias}\PYG{p}{.}\PYG{n+na}{computeIfAbsent}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{k}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashSet}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{primero}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Resolver dependencias}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{cambios}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{do}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{cambios}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Map}\PYG{p}{.}\PYG{n+na}{Entry}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{entry}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{dependencias}\PYG{p}{.}\PYG{n+na}{entrySet}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{entry}\PYG{p}{.}\PYG{n+na}{getKey}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{dependientes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{entry}\PYG{p}{.}\PYG{n+na}{getValue}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{dependiente}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{dependientes}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{sizeAntes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{dependiente}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{sizeAntes}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{cambios}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{cambios}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Actualizar los conjuntos primeros en los no terminales}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{conjuntoPrimero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{primeros}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{listaPrimero}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{conjuntoPrimero}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{listaPrimero}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Terminal}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{setPrimeros}\PYG{p}{(}\PYG{n}{listaPrimero}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{generarConjSig}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{Map}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{siguientes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashMap}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Inicializar conjuntos siguientes para cada no terminal}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{put}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashSet}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Asignar el símbolo de fin de cadena (\PYGZdl{}) al símbolo inicial}
\PYG{+w}{        }\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getSimbInicial}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdl{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Primer recorrido: agregar terminales que siguen a no terminales directamente}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{Simbolo}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{isNoTerminal}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{isTerminal}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{c+c1}{// Resolver dependencias y agregar conjuntos siguientes de no terminales}
\PYG{+w}{        }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n}{cambios}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{do}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{cambios}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{Simbolo}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{antecedente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{+}\PYG{o}{+}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{isNoTerminal}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{conjSig}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{sizeAntes}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{conjSig}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                        }\PYG{c+c1}{// Agregar siguientes del antecedente si es el último símbolo o si el siguiente símbolo puede derivar en épsilon}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{puedeDerivarEnEpsilon}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{conjSig}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{antecedente}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                        }\PYG{c+c1}{// Agregar primeros del siguiente símbolo si es no terminal}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{isNoTerminal}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{conjSig}\PYG{p}{.}\PYG{n+na}{addAll}\PYG{p}{(}\PYG{n}{getPrimerosSinEpsilon}\PYG{p}{(}\PYG{n}{consecuente}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{conjSig}\PYG{p}{.}\PYG{n+na}{size}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{sizeAntes}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                            }\PYG{n}{cambios}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{                        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{cambios}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{c+c1}{// Actualizar los conjuntos siguientes en los no terminales}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{conjuntoSiguiente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{siguientes}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{ObservableList}\PYG{o}{\PYGZlt{}}\PYG{n}{Terminal}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{listaSiguiente}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{FXCollections}\PYG{p}{.}\PYG{n+na}{observableArrayList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{conjuntoSiguiente}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{n}{listaSiguiente}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{k}{new}\PYG{+w}{ }\PYG{n}{Terminal}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{setSiguientes}\PYG{p}{(}\PYG{n}{listaSiguiente}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{k+kt}{boolean}\PYG{+w}{ }\PYG{n+nf}{puedeDerivarEnEpsilon}\PYG{p}{(}\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{isTerminal}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}
\PYG{+w}{                    }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{u03b5}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{true}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{k+kc}{false}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getPrimerosSinEpsilon}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{nombreNoTerminal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{primerosSinEpsilon}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{HashSet}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nombreNoTerminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getPrimeros}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{!}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZbs{}}\PYG{l+s}{u03b5}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{primerosSinEpsilon}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{primerosSinEpsilon}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getProduccion}\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{terminal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{reglas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// 1️⃣ Verificar si el terminal está en el conjunto Primero del consecuente}
\PYG{+w}{                }\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{c+c1}{// 2️⃣ Si el primer símbolo es ε, agregarlo si el terminal está en Siguiente}
\PYG{+w}{                }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getSiguientes}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{anyMatch}\PYG{p}{(}\PYG{n}{t}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{c+c1}{// 3️⃣ Si el terminal está en Primero del No Terminal}
\PYG{+w}{                }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getPrimeros}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{anyMatch}\PYG{p}{(}\PYG{n}{t}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{?}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{n}{String}\PYG{p}{.}\PYG{n+na}{join}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{, }\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{reglas}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getProduccionesPorNoTerminalYTerminal}\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{reglas}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{ArrayList}\PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Produccion}\PYG{+w}{ }\PYG{n}{pr}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getProducciones}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getAntec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getSimboloNT}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{isEmpty}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{continue}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Producción vacía}

\PYG{+w}{                }\PYG{n}{Simbolo}\PYG{+w}{ }\PYG{n}{primerSimbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{getConsec}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{get}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}

\PYG{+w}{                }\PYG{c+c1}{// 1. Si el primer símbolo es el terminal que buscamos}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{c+c1}{// 2. Si el primer símbolo es épsilon y el terminal está en SIGUIENTE}
\PYG{+w}{                }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ε}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }
\PYG{+w}{                         }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getSiguientes}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{anyMatch}\PYG{p}{(}\PYG{n}{s}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{s}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{c+c1}{// 3. Si el primer símbolo es un no terminal y el terminal está en su conjunto PRIMERO}
\PYG{+w}{                }\PYG{k}{else}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{isNoTerminal}\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{primerNT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                        }\PYG{p}{.}\PYG{n+na}{filter}\PYG{p}{(}\PYG{n}{n}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{primerSimbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{                        }\PYG{p}{.}\PYG{n+na}{findFirst}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                        }\PYG{p}{.}\PYG{n+na}{orElse}\PYG{p}{(}\PYG{k+kc}{null}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{primerNT}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{primerNT}\PYG{p}{.}\PYG{n+na}{getPrimeros}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                            }\PYG{p}{.}\PYG{n+na}{anyMatch}\PYG{p}{(}\PYG{n}{term}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{t}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                        }\PYG{n}{reglas}\PYG{p}{.}\PYG{n+na}{add}\PYG{p}{(}\PYG{n}{pr}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}

\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{reglas}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getProduccionesPorNoTerminalYTerminal}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{noTerminal}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n}{terminal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Buscar el no terminal y el terminal en las listas correspondientes}
\PYG{+w}{        }\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{noTerminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{filter}\PYG{p}{(}\PYG{n}{n}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{noTerminal}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{findFirst}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{orElse}\PYG{p}{(}\PYG{k+kc}{null}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }
\PYG{+w}{        }\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{terminales}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{filter}\PYG{p}{(}\PYG{n}{term}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{term}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{terminal}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{findFirst}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{orElse}\PYG{p}{(}\PYG{k+kc}{null}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }
\PYG{+w}{        }\PYG{c+c1}{// Si no se encuentran, devolver una lista vacía}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{+w}{ }\PYG{o}{|}\PYG{o}{|}\PYG{+w}{ }\PYG{n}{t}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{Collections}\PYG{p}{.}\PYG{n+na}{emptyList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }
\PYG{+w}{        }\PYG{c+c1}{// Llamar al método existente con los objetos encontrados}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{getProduccionesPorNoTerminalYTerminal}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{t}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k+kd}{public}\PYG{+w}{ }\PYG{n}{Set}\PYG{o}{\PYGZlt{}}\PYG{n}{String}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n+nf}{getFollow}\PYG{p}{(}\PYG{n}{String}\PYG{+w}{ }\PYG{n}{noTerminal}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Buscar el no terminal en la lista de no terminales}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{NoTerminal}\PYG{+w}{ }\PYG{n}{nt}\PYG{+w}{ }\PYG{p}{:}\PYG{+w}{ }\PYG{k}{this}\PYG{p}{.}\PYG{n+na}{getNoTerminales}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{equals}\PYG{p}{(}\PYG{n}{noTerminal}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                }\PYG{c+c1}{// Convertir ObservableList\PYGZlt{}Terminal\PYGZgt{} a Set\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{nt}\PYG{p}{.}\PYG{n+na}{getSiguientes}\PYG{p}{(}\PYG{p}{)}\PYG{p}{.}\PYG{n+na}{stream}\PYG{p}{(}\PYG{p}{)}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{map}\PYG{p}{(}\PYG{n}{Terminal}\PYG{p}{:}\PYG{p}{:}\PYG{n}{getNombre}\PYG{p}{)}\PYG{+w}{ }\PYG{c+c1}{// Obtener el nombre de cada terminal}
\PYG{+w}{                         }\PYG{p}{.}\PYG{n+na}{collect}\PYG{p}{(}\PYG{n}{Collectors}\PYG{p}{.}\PYG{n+na}{toSet}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Convertir a Set\PYGZlt{}String\PYGZgt{}}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{Collections}\PYG{p}{.}\PYG{n+na}{emptySet}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Devuelve un conjunto vacío si no se encuentra el no terminal}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }
\PYG{+w}{    }\PYG{c+cm}{/**}
\PYG{c+cm}{     * Obtiene la descripción de una función de error en el idioma correspondiente.}
\PYG{c+cm}{     */}
\PYG{+w}{    }\PYG{k+kd}{private}\PYG{+w}{ }\PYG{n}{String}\PYG{+w}{ }\PYG{n+nf}{getDescripcionFuncionError}\PYG{p}{(}\PYG{n}{FuncionError}\PYG{+w}{ }\PYG{n}{fe}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ResourceBundle}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{fe}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{+w}{        }
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{accion}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fe}\PYG{p}{.}\PYG{n+na}{getAccion}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{Terminal}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fe}\PYG{p}{.}\PYG{n+na}{getSimbolo}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }
\PYG{+w}{        }\PYG{k}{switch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{accion}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{TERMINAR\PYGZus{}ANALISIS}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.terminar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{BORRAR\PYGZus{}ENTRADA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.borrar.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{INSERTAR\PYGZus{}ENTRADA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.insertar.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.insertar.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{MODIFICAR\PYGZus{}ENTRADA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.modificar.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.modificar.entrada}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{INSERTAR\PYGZus{}PILA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.insertar.pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.insertar.pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{BORRAR\PYGZus{}PILA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.borrar.pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{n}{FuncionError}\PYG{p}{.}\PYG{n+na}{MODIFICAR\PYGZus{}PILA}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{simbolo}\PYG{+w}{ }\PYG{o}{!}\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{null}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.modificar.pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{: }\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{simbolo}\PYG{p}{.}\PYG{n+na}{getNombre}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{                    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{bundle}\PYG{p}{.}\PYG{n+na}{getString}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{funcion.error.modificar.pila}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{p}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{default}\PYG{p}{:}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{fe}\PYG{p}{.}\PYG{n+na}{toString}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{p}{\PYGZcb{}}
\end{MintedVerbatim}
